var robotArm=function(){var a={};a.speed=75,a.rows=8,a.columns=10;var b={};b.hasInitialized=!1,b.canvas=null,b.ctx=null,b.baseColumnSeparatorHeight=10,b.robotArmHeight=25,b.robotArmHookHeight=10,b.baseColumnSeparatorBlockPadding=5,b.armCurrentColumn=0,b.blockMap=null,b.currentHeldBlock=null,b.animationList=[],b.hasAnimatedFrame=!1,b.armAnimationName=null,b.armMovingDown=null,b.armAnimationProgress=0,b.state={blockMap:null,currentHeldBlock:null,armCurrentColumn:0},a.initialize=function(a){if(null==a||void 0==a)throw new Error("Canvas parameter is null or undefined");if("CANVAS"!=a.nodeName)throw new Error("Element is not of type canvas");b.canvas=a,b.ctx=a.getContext("2d"),b.hasInitialized=!0},a.loadLevel=function(a){switch(a){case"exercise 1":b.blockMap=[["blue","red"],["blue"],["green"],["yellow","violet","lightgreen"]],b.state.blockMap=[["blue","red"],["blue"],["green"],["yellow","violet","lightgreen"]];break;case"exercise 2":b.blockMap=[["blue","red","green","green"],["blue","cyan"],[],["yellow","violet","lightgreen"]],b.state.blockMap=[["blue","red","green","green"],["blue","cyan"],[],["yellow","violet","lightgreen"]];break;default:throw new Error("Invalid level name: "+a)}},a.randomLevel=function(c,d){var e=["red","blue","green","orange","yellow","purple","cyan","pink"];c=c?c:a.columns,d=d?d:a.rows;for(var f=[],g=0;g<c;g++){f[g]=[];for(var h=Math.floor(Math.random()*d-1),i=0;i<h;i++)f[g][i]=e[Math.floor(Math.random()*e.length)]}b.blockMap=f.slice(),b.state.blockMap=f.slice()},a.moveRight=function(){b.state.armCurrentColumn+1<a.columns&&b.state.armCurrentColumn++,b.animationList.push(function(c,d){if(d){if(b.armCurrentColumn+1>=a.columns)return!0;if(b.armAnimationName="moveRight",!(b.armAnimationProgress<=b.canvas.width/a.columns))return b.armCurrentColumn++,b.armAnimationName=null,b.armAnimationProgress=0,!0;b.armAnimationProgress+=a.speed/c,b.hasAnimatedFrame=!0}})},a.moveLeft=function(){b.state.armCurrentColumn-1>0&&b.state.armCurrentColumn--,b.animationList.push(function(c,d){if(d){if(b.armCurrentColumn-1<0)return!0;if(b.armAnimationName="moveLeft",!(b.armAnimationProgress<=b.canvas.width/a.columns))return b.armCurrentColumn--,b.armAnimationName=null,b.armAnimationProgress=0,!0;b.armAnimationProgress+=a.speed/c,b.hasAnimatedFrame=!0}})},a.grab=function(){null==b.state.currentHeldBlock&&b.state.blockMap[b.state.armCurrentColumn].length>0&&(b.state.currentHeldBlock=b.state.blockMap[b.state.armCurrentColumn][b.state.blockMap[b.state.armCurrentColumn].length-1],b.state.blockMap[b.state.armCurrentColumn].splice(b.state.blockMap[b.state.armCurrentColumn].length-1,1)),b.animationList.push(function(c,d){if(d){if(!this.notFirstRun&&(null!=b.currentHeldBlock&&b.armMovingDown||b.armCurrentColumn>=b.blockMap.length||b.blockMap[b.armCurrentColumn].length<=0))return!0;if(b.hasAnimatedFrame=!0,b.armAnimationName="grab",b.armMovingDown||null==b.armMovingDown){b.armMovingDown=!0;var e=b.blockMap[b.armCurrentColumn].length,f=b.getAvailableTotalRowsHeight(canvas)/a.rows,g=b.canvas.height-e*f-6;g>=b.armAnimationProgress+b.robotArmHeight?b.armAnimationProgress+=a.speed/c:(b.armMovingDown=!1,b.currentHeldBlock=b.blockMap[b.armCurrentColumn][b.blockMap[b.armCurrentColumn].length-1],b.blockMap[b.armCurrentColumn].splice(b.blockMap[b.armCurrentColumn].length-1,1))}else{if(!(0<b.armAnimationProgress))return b.armAnimationProgress=0,b.armAnimationName=null,b.armMovingDown=null,!0;b.armAnimationProgress-=a.speed/c}this.notFirstRun=!0}})},a.drop=function(){null!=b.state.currentHeldBlock&&(void 0==b.state.blockMap[b.state.armCurrentColumn]&&(b.state.blockMap[b.state.armCurrentColumn]=[]),b.state.blockMap[b.state.armCurrentColumn].push(b.state.currentHeldBlock),b.state.currentHeldBlock=null),b.animationList.push(function(c,d){if(d)if(b.hasAnimatedFrame=!0,b.armAnimationName="drop",b.armMovingDown||null==b.armMovingDown){b.armMovingDown=!0;var e=(void 0!=b.blockMap[b.armCurrentColumn]?b.blockMap[b.armCurrentColumn]:[]).length,f=b.getAvailableTotalRowsHeight(canvas)/a.rows,g=b.canvas.height-(e+1)*f-6;g>=b.armAnimationProgress+b.robotArmHeight?b.armAnimationProgress+=a.speed/c:(b.armMovingDown=!1,void 0==b.blockMap[b.armCurrentColumn]&&(b.blockMap[b.armCurrentColumn]=[]),null!=b.currentHeldBlock&&b.blockMap[b.armCurrentColumn].push(b.currentHeldBlock),b.currentHeldBlock=null)}else{if(!(0<b.armAnimationProgress))return b.armAnimationProgress=0,b.armAnimationName=null,b.armMovingDown=null,!0;b.armAnimationProgress-=a.speed/c}})},a.scan=function(){return b.state.currentHeldBlock};var c;return a.run=function(){var d=(new Date).getTime(),e=d-(c||d);b.hasAnimatedFrame=!1,b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height),b.ctx.beginPath(),b.ctx.fillStyle="lightgrey",b.ctx.fillRect(0,0,canvas.width,canvas.height),b.drawBase(b.canvas,b.ctx),b.drawBlocks(b.canvas,b.ctx,b.blockMap),b.drawArm(b.canvas,b.ctx);for(var f=[],g=0;g<b.animationList.length;g++)b.animationList[g](0!=e?e:9999999,!b.hasAnimatedFrame)&&f.push(g);for(var g=f.length-1;g>=0;g--)b.animationList.splice(f[g],1);b.ctx.stroke(),c=d,requestAnimationFrame(a.run)},b.getAvailableTotalRowsHeight=function(a){return a.height-b.robotArmHeight-b.robotArmHookHeight},b.drawBase=function(c,d){if(a.columns<=0)throw new Error("Robot arm columns can't be less than or equal to 0");d.strokeStyle="#000",d.moveTo(0,c.height),d.lineTo(c.width,c.height);for(var e=c.width/a.columns,f=0;f<a.columns+1;f++)d.moveTo(f*e,c.height),d.lineTo(f*e,c.height-b.baseColumnSeparatorHeight)},b.drawBlocks=function(c,d,e){if("object"!=typeof e)throw new Error("blockMap must be of type array");if(a.columns<=0)throw new Error("Robot arm columns can't be less than or equal to 0");b.blockMap=e;for(var f=c.width/a.columns,g=b.getAvailableTotalRowsHeight(c)/a.rows,h=c.width/a.columns-2*b.baseColumnSeparatorBlockPadding,i=0;i<e.length;i++)for(var j=0;j<e[i].length;j++){var k=i*f;d.fillStyle=e[i][j],d.fillRect(k+b.baseColumnSeparatorBlockPadding+1,c.height-g*(j+1)-1,h,g-1),d.strokeStyle="#000",d.rect(k+b.baseColumnSeparatorBlockPadding,c.height-g*(j+1)-1,h,g)}},b.drawArm=function(c,d){d.strokeStyle="#000";var e=c.width/a.columns+2,f=b.armCurrentColumn*e,g=c.width/a.columns-2*b.baseColumnSeparatorBlockPadding,h=0,i=0;if(null!=b.armAnimationName)switch(b.armAnimationName){case"moveRight":h=b.armAnimationProgress;break;case"moveLeft":h=-b.armAnimationProgress;break;case"grab":i=b.armAnimationProgress;break;case"drop":i=b.armAnimationProgress}if(h-=2*b.armCurrentColumn+1,d.moveTo(h+f+e/2,0),d.lineTo(h+f+e/2,b.robotArmHeight+i),d.moveTo(h+f+b.baseColumnSeparatorBlockPadding,b.robotArmHeight+i),d.lineTo(h+f+e-b.baseColumnSeparatorBlockPadding,b.robotArmHeight+i),d.moveTo(h+f+b.baseColumnSeparatorBlockPadding,b.robotArmHeight+i),d.lineTo(h+f+b.baseColumnSeparatorBlockPadding,b.robotArmHeight+b.robotArmHookHeight+i),d.moveTo(h+f+e-b.baseColumnSeparatorBlockPadding,b.robotArmHeight+i),d.lineTo(h+f+e-b.baseColumnSeparatorBlockPadding,b.robotArmHeight+b.robotArmHookHeight+i),null!=b.currentHeldBlock){var j=b.getAvailableTotalRowsHeight(c)/a.rows;d.fillStyle=b.currentHeldBlock,d.fillRect(h+f+b.baseColumnSeparatorBlockPadding+2,b.robotArmHeight+1+i,g-1,j-1),d.strokeStyle="#000",d.rect(h+f+b.baseColumnSeparatorBlockPadding+1,b.robotArmHeight+1+i,g,j)}},a.getPd=function(){return b},a}(),requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(a){return setTimeout(a,1)};